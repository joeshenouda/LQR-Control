%
% F-8 Aircraft LQG Optimal Control
%
clear all
n=4
m1=1
m2=1
r=2
%
A=[-0.01357  -32.2  -46.3  0;
    0.00012    0    1.214  0;
   -0.0001212  0   -1.214  1;
   0.00057     0   -9.01  -0.6696]
B=[-0.433; 0.1394; -0.1394; -0.1577]
G=[-46.3; 1.214; -1.214; -9.01]
W1=[0.000315]
W2=[0.000686 0;
    0 40]
C=[0 0 0 1;
    1 0 0 0];
D=zeros(2,1)
x0=[1 1 1 1]'
R1=diag([0.001,0, 3260, 3260])
R2=3260
% Optimal control
[F,P]=lqr(A,B,R1,R2);
[K,PF]=lqe(A,G,C,W1,W2)
Jopt=trace(P*G*W1*G'+PF*F'*R2*F)